http://www.codingdojo.org/cgi-bin/index.pl?KataBankOCR

#KataBankOCR

# 問題描述

## User Story 1

你為一家銀行工作，最近買一個巧妙的機器來協助閱讀分公司送來的信件及傳真。這台機器會掃描紙本文件，然後產出包含如下數字組合的檔案：
```
    _  _     _  _  _  _  _
  | _| _||_||_ |_   ||_||_|
  ||_  _|  | _||_|  ||_| _| 

```
每組高度為四行，每行27個字元。每組的前3行是用"|"和"_"兩種符號寫成的帳號，第四行是空白的。每一個帳號應該有9位數字，範圍都是0-9。一般一個檔案會包含大約500組資料。

你的第一個工作就是寫一個程式將檔案解析成正確的帳號。

## User Story 2

完成之後，你很快就發現並沒有這麼萬無一失，有時候掃描會出錯。因此下一步就是驗證讀到的數字是實際有效的帳號。一個合法的帳號會包含一個合法的校對碼，可以透過以下方式計算：

```
帳號:  3  4  5  8  8  2  8  6  5
位置:  d9 d8 d7 d6 d5 d4 d3 d2 d1

校對碼計算結果:
(d1+2*d2+3*d3 +..+9*d9) mod 11 = 0

```
所以接下來你應該要寫一些程式來計算校對碼，來辨別帳號是否正確。

## User Story 3

你的老闆希望能看到你的結果，他要求你將你從每個檔案發現的結果輸出到一個檔案上，如下格式

```
457508000
664371495 ERR
86110??36 ILL
```

檔案包含每行一個帳號。如果有些字讀取不清楚，則用"?"取代。如果有發生校對碼計算錯誤或是不清楚的數字，則在檔案的第二列顯示狀態。

## User Story 4

事實證明常常會發生一些錯誤是因為掃描器沒有正確處理"|"和"_"，舉例來說：

```
    _  _  _  _  _  _     _ 
|_||_|| || ||_   |  |  ||_ 
  | _||_||_||_|  |  |  | _|
  
``` 

如果掃描結果漏掉一個"|"，9可能就變8了，或8也可能變成0。1可能是7，5可能是9或6。所以你的下一個工作就是回頭看看有ERR或ILL的數字，然後嘗試猜測增加或移除一個 "|"或"_"後它們有可能是什麼數字。如果只存在一個可能的結果會讓校對碼正確，就使用它。如果有多個可能結果，那狀態就設為AMB。如果仍然找不出可能的結果，那狀態應該為ILL。

### 線索

建議你找出輸出3x3格的方式來寫程式，這樣他們就可以變成一個可辨識的數字，畢竟這樣的程式

```
"   " +
"|_|" +
"  |"
```
永遠比起
```
"   |_|  |"
``` 
好讀多了。

當Christophe和Emmanuel在XP2005提出這個Kata時他們使用遞迴來解決問題，許多人會覺得用迭代比較舒服。請兩種都嘗試看看。

### 一些應該避免的陷阱

- 仔細閱讀校正碼的正確定義，這不是一個簡單的順序相乘，相乘的數字跟順序是相反的。 
- 這份規格並沒有列出所有數字可能再變動一個"|"或|_"就可被替代的方案。
- 別忘了嘗試找出?可能再增加或減少一個"|"或|_"後可能會變成的數字。

### 建議的測試案例

如果你想要複製貼上測試案例到你的編輯器上，建議你檢視原始資料，已確保複製到所有必需的空白

#### use case 1
``` 
 _  _  _  _  _  _  _  _  _ 
| || || || || || || || || |
|_||_||_||_||_||_||_||_||_|

```                           
=> 000000000
```
                           
  |  |  |  |  |  |  |  |  |
  |  |  |  |  |  |  |  |  |
  
```                           
=> 111111111
```
 _  _  _  _  _  _  _  _  _ 
 _| _| _| _| _| _| _| _| _|
|_ |_ |_ |_ |_ |_ |_ |_ |_ 
                           
```
=> 222222222
```
 _  _  _  _  _  _  _  _  _ 
 _| _| _| _| _| _| _| _| _|
 _| _| _| _| _| _| _| _| _|
                           
```
=> 333333333
```
                           
|_||_||_||_||_||_||_||_||_|
  |  |  |  |  |  |  |  |  |
                           
```
=> 444444444
```
 _  _  _  _  _  _  _  _  _ 
|_ |_ |_ |_ |_ |_ |_ |_ |_ 
 _| _| _| _| _| _| _| _| _|
                           
```
=> 555555555
```
 _  _  _  _  _  _  _  _  _ 
|_ |_ |_ |_ |_ |_ |_ |_ |_ 
|_||_||_||_||_||_||_||_||_|
                           
```
=> 666666666
```
 _  _  _  _  _  _  _  _  _ 
  |  |  |  |  |  |  |  |  |
  |  |  |  |  |  |  |  |  |
                           
```
=> 777777777
```
 _  _  _  _  _  _  _  _  _ 
|_||_||_||_||_||_||_||_||_|
|_||_||_||_||_||_||_||_||_|
                           
```
=> 888888888
```
 _  _  _  _  _  _  _  _  _ 
|_||_||_||_||_||_||_||_||_|
 _| _| _| _| _| _| _| _| _|
                           
```
=> 999999999
```
    _  _     _  _  _  _  _
  | _| _||_||_ |_   ||_||_|
  ||_  _|  | _||_|  ||_| _| 
                           
```
=> 123456789

#### use case 3

```
 _  _  _  _  _  _  _  _    
| || || || || || || ||_   |
|_||_||_||_||_||_||_| _|  |
                           
```
=> 000000051
```
    _  _  _  _  _  _     _ 
|_||_|| || ||_   |  |  | _ 
  | _||_||_||_|  |  |  | _|
                           
```
=> 49006771? ILL
```
    _  _     _  _  _  _  _ 
  | _| _||_| _ |_   ||_||_|
  ||_  _|  | _||_|  ||_| _ 
                            
```
=> 1234?678? ILL

#### use case 4
```
                           
  |  |  |  |  |  |  |  |  |
  |  |  |  |  |  |  |  |  |

```                           
=> 711111111
```
 _  _  _  _  _  _  _  _  _ 
  |  |  |  |  |  |  |  |  |
  |  |  |  |  |  |  |  |  |
                           
```
=> 777777177
```
 _  _  _  _  _  _  _  _  _ 
 _|| || || || || || || || |
|_ |_||_||_||_||_||_||_||_|
                           
```
=> 200800000
```
 _  _  _  _  _  _  _  _  _ 
 _| _| _| _| _| _| _| _| _|
 _| _| _| _| _| _| _| _| _|
                           
```
=> 333393333
``` 
 _  _  _  _  _  _  _  _  _ 
|_||_||_||_||_||_||_||_||_|
|_||_||_||_||_||_||_||_||_|
                           
```
=> 888888888 AMB ['888886888', '888888880', '888888988']
```
 _  _  _  _  _  _  _  _  _ 
|_ |_ |_ |_ |_ |_ |_ |_ |_ 
 _| _| _| _| _| _| _| _| _|
                           
```
=> 555555555 AMB ['555655555', '559555555']
```
 _  _  _  _  _  _  _  _  _ 
|_ |_ |_ |_ |_ |_ |_ |_ |_ 
|_||_||_||_||_||_||_||_||_|
                           
```
=> 666666666 AMB ['666566666', '686666666']
```
 _  _  _  _  _  _  _  _  _ 
|_||_||_||_||_||_||_||_||_|
 _| _| _| _| _| _| _| _| _|
                           
```
=> 999999999 AMB ['899999999', '993999999', '999959999']
```
    _  _  _  _  _  _     _ 
|_||_|| || ||_   |  |  ||_ 
  | _||_||_||_|  |  |  | _|
                           
```
=> 490067715 AMB ['490067115', '490067719', '490867715']
```
    _  _     _  _  _  _  _ 
 _| _| _||_||_ |_   ||_||_|
  ||_  _|  | _||_|  ||_| _| 
                           
```
=> 123456789
```
 _     _  _  _  _  _  _    
| || || || || || || ||_   |
|_||_||_||_||_||_||_| _|  |
                           
```
=> 000000051
```
    _  _  _  _  _  _     _ 
|_||_|| ||_||_   |  |  | _ 
  | _||_||_||_|  |  |  | _|
                           
```
=> 490867715 
